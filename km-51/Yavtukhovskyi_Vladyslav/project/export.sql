--------------------------------------------------------
--  File created - סנוהא-םגאנ-16-2019   
--------------------------------------------------------
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28053_DUMMY_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28053_DUMMY_1 as table of number;
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28053_30_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28053_30_1 as table of "VLOD"."SYS_PLSQL_28053_9_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28053_9_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28053_9_1 as object (KEYQ VARCHAR2(20),
VALQ VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28060_DUMMY_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28060_DUMMY_1 as table of number;
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28060_30_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28060_30_1 as object (LOGS VARCHAR2(16),
PASS VARCHAR2(16),
U_NAME VARCHAR2(40),
U_BIRTH DATE);
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28060_69_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28060_69_1 as table of "VLOD"."SYS_PLSQL_28060_30_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28573_DUMMY_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28573_DUMMY_1 as table of number;
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28573_103_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28573_103_1 as table of "VLOD"."SYS_PLSQL_28573_33_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28573_21_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28573_21_1 as object (WEK VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28573_33_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28573_33_1 as object (SYN VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28573_87_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28573_87_1 as table of "VLOD"."SYS_PLSQL_28573_21_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28573_9_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28573_9_1 as object (MED VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_28573_95_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_28573_95_1 as table of "VLOD"."SYS_PLSQL_28573_9_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29478_DUMMY_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29478_DUMMY_1 as table of number;
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29478_21_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29478_21_1 as table of "VLOD"."SYS_PLSQL_29478_9_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29478_9_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29478_9_1 as object (MED VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29489_DUMMY_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29489_DUMMY_1 as table of number;
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29489_21_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29489_21_1 as table of "VLOD"."SYS_PLSQL_29489_9_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29489_9_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29489_9_1 as object (WEK VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29494_DUMMY_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29494_DUMMY_1 as table of number;
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29494_21_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29494_21_1 as table of "VLOD"."SYS_PLSQL_29494_9_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29494_9_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29494_9_1 as object (SYN VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29499_DUMMY_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29499_DUMMY_1 as table of number;
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29499_21_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29499_21_1 as table of "VLOD"."SYS_PLSQL_29499_9_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29499_29_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29499_29_1 as object (MED VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29499_41_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29499_41_1 as table of "VLOD"."SYS_PLSQL_29499_29_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29499_49_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29499_49_1 as object (MED VARCHAR2(20),
WEK VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29499_70_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29499_70_1 as table of "VLOD"."SYS_PLSQL_29499_49_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29499_9_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29499_9_1 as object (WEK VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29508_DUMMY_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29508_DUMMY_1 as table of number;
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29508_21_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29508_21_1 as table of "VLOD"."SYS_PLSQL_29508_9_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29508_29_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29508_29_1 as object (SYN VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29508_41_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29508_41_1 as table of "VLOD"."SYS_PLSQL_29508_29_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29508_49_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29508_49_1 as object (WEK VARCHAR2(20),
SYN VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29508_70_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29508_70_1 as table of "VLOD"."SYS_PLSQL_29508_49_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29508_9_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29508_9_1 as object (WEK VARCHAR2(20));
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29517_DUMMY_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29517_DUMMY_1 as table of number;
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29517_104_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29517_104_1 as table of "VLOD"."SYS_PLSQL_29517_87_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29517_54_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29517_54_1 as table of "VLOD"."SYS_PLSQL_29517_9_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29517_62_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29517_62_1 as object (MED VARCHAR2(20),
NUMBS NUMBER);
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29517_79_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29517_79_1 as table of "VLOD"."SYS_PLSQL_29517_62_1";
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29517_87_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29517_87_1 as object (WEK VARCHAR2(20),
NUMBS NUMBER);
-- Unable to render TYPE DDL for object VLOD.SYS_PLSQL_29517_9_1 with DBMS_METADATA attempting internal generator.
CREATE TYPE        SYS_PLSQL_29517_9_1 as object (WEK VARCHAR2(20),
MED VARCHAR2(20),
SYN VARCHAR2(20),
DIAG DATE,
BEG DATE,
EN DATE);
--------------------------------------------------------
--  DDL for Table DIAGNOSIS
--------------------------------------------------------

  CREATE TABLE "VLOD"."DIAGNOSIS" 
   (	"DIAG" VARCHAR2(20)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table HEALING_HISTORIES
--------------------------------------------------------

  CREATE TABLE "VLOD"."HEALING_HISTORIES" 
   (	"ID" NUMBER(*,0), 
	"LOGIN" VARCHAR2(16), 
	"NAME_OF_WEAKNESS" VARCHAR2(20), 
	"NAME_OF_MEDICINE" VARCHAR2(20), 
	"NAME_OF_SYNDROM" VARCHAR2(20), 
	"DATE_OF_DIAGNOSIS" DATE, 
	"DATE_OF_BEGIN" DATE, 
	"DATE_OF_END" DATE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table MEDICINE
--------------------------------------------------------

  CREATE TABLE "VLOD"."MEDICINE" 
   (	"NAME_OF_MEDICINE" VARCHAR2(20)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table MEDICINE_IS_FOR_WEAKNESS
--------------------------------------------------------

  CREATE TABLE "VLOD"."MEDICINE_IS_FOR_WEAKNESS" 
   (	"NAME_OF_WEAKNESS" VARCHAR2(20), 
	"NAME_OF_MEDICINE" VARCHAR2(20)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table SYNDROMES
--------------------------------------------------------

  CREATE TABLE "VLOD"."SYNDROMES" 
   (	"NAME_OF_SYNDROM" VARCHAR2(20)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table TESTPCK
--------------------------------------------------------

  CREATE TABLE "VLOD"."TESTPCK" 
   (	"KEYPCK" VARCHAR2(20), 
	"VALUEPCK" VARCHAR2(20)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table USERSS
--------------------------------------------------------

  CREATE TABLE "VLOD"."USERSS" 
   (	"LOGIN" VARCHAR2(16), 
	"PASSWORD" VARCHAR2(16), 
	"USER_NAME" VARCHAR2(40), 
	"DATE_OF_BIRTH" DATE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table WEAKNESS
--------------------------------------------------------

  CREATE TABLE "VLOD"."WEAKNESS" 
   (	"NAME_OF_WEAKNESS" VARCHAR2(20)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Table WEAKNESS_HAS_SYNDROM
--------------------------------------------------------

  CREATE TABLE "VLOD"."WEAKNESS_HAS_SYNDROM" 
   (	"NAME_OF_SYNDROM" VARCHAR2(20), 
	"NAME_OF_WEAKNESS" VARCHAR2(20)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
REM INSERTING into VLOD.DIAGNOSIS
SET DEFINE OFF;
Insert into VLOD.DIAGNOSIS (DIAG) values ('A');
Insert into VLOD.DIAGNOSIS (DIAG) values ('B');
Insert into VLOD.DIAGNOSIS (DIAG) values ('G');
Insert into VLOD.DIAGNOSIS (DIAG) values ('D');
Insert into VLOD.DIAGNOSIS (DIAG) values ('E');
REM INSERTING into VLOD.HEALING_HISTORIES
SET DEFINE OFF;
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('14','qqq1','really bad day sir','Not new medicine','leg is broken',to_date('02.01.2019','DD.MM.RRRR'),to_date('13.01.2019','DD.MM.RRRR'),to_date('31.01.2019','DD.MM.RRRR'));
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('15','qqq1','really bad day sir','Not new medicine','Apchu',to_date('01.01.2019','DD.MM.RRRR'),to_date('01.01.2019','DD.MM.RRRR'),to_date('02.01.2019','DD.MM.RRRR'));
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('16','qqq1','really bad day sir','Not new medicine','Apchu',to_date('29.01.2019','DD.MM.RRRR'),to_date('30.01.2019','DD.MM.RRRR'),to_date('31.01.2019','DD.MM.RRRR'));
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('17','qqq1','broken leg','new leg','leg is broken',to_date('02.01.2019','DD.MM.RRRR'),to_date('04.01.2019','DD.MM.RRRR'),to_date('06.01.2019','DD.MM.RRRR'));
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('18','qqq1','broken leg','new leg','leg is broken',to_date('06.01.2019','DD.MM.RRRR'),to_date('05.01.2019','DD.MM.RRRR'),to_date('15.01.2019','DD.MM.RRRR'));
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('7','eqeq','really bad day sir','Not new medicine',null,to_date('03.04.2012','DD.MM.RRRR'),null,null);
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('11','expo12','really bad day sir','Not new medicine','Apchu',to_date('12.05.2002','DD.MM.RRRR'),null,null);
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('12','expo12','really bad day sir','Not new medicine','Apchu',to_date('29.11.2015','DD.MM.RRRR'),to_date('29.11.2018','DD.MM.RRRR'),to_date('06.09.2018','DD.MM.RRRR'));
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('9','eqeq','really bad day sir',null,'Apchu',to_date('03.04.2012','DD.MM.RRRR'),null,null);
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('19','qqq1','broken leg','new leg','leg is broken',to_date('20.12.2018','DD.MM.RRRR'),to_date('28.12.2018','DD.MM.RRRR'),to_date('30.12.2018','DD.MM.RRRR'));
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('20','expo12','broken leg','new leg','leg is broken',to_date('02.01.2019','DD.MM.RRRR'),to_date('04.01.2019','DD.MM.RRRR'),to_date('06.01.2019','DD.MM.RRRR'));
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('21','expo12','broken leg','new leg','leg is broken',to_date('09.01.2019','DD.MM.RRRR'),to_date('09.01.2019','DD.MM.RRRR'),to_date('11.01.2019','DD.MM.RRRR'));
Insert into VLOD.HEALING_HISTORIES (ID,LOGIN,NAME_OF_WEAKNESS,NAME_OF_MEDICINE,NAME_OF_SYNDROM,DATE_OF_DIAGNOSIS,DATE_OF_BEGIN,DATE_OF_END) values ('22','expo12','broken leg','new leg','leg is broken',to_date('03.01.2019','DD.MM.RRRR'),to_date('05.01.2019','DD.MM.RRRR'),to_date('06.01.2019','DD.MM.RRRR'));
REM INSERTING into VLOD.MEDICINE
SET DEFINE OFF;
Insert into VLOD.MEDICINE (NAME_OF_MEDICINE) values ('Not new medicine');
Insert into VLOD.MEDICINE (NAME_OF_MEDICINE) values ('new arm');
Insert into VLOD.MEDICINE (NAME_OF_MEDICINE) values ('new leg');
Insert into VLOD.MEDICINE (NAME_OF_MEDICINE) values ('new_arm');
Insert into VLOD.MEDICINE (NAME_OF_MEDICINE) values ('nothing shall help');
Insert into VLOD.MEDICINE (NAME_OF_MEDICINE) values ('opgg');
REM INSERTING into VLOD.MEDICINE_IS_FOR_WEAKNESS
SET DEFINE OFF;
Insert into VLOD.MEDICINE_IS_FOR_WEAKNESS (NAME_OF_WEAKNESS,NAME_OF_MEDICINE) values ('broken arm','new arm');
Insert into VLOD.MEDICINE_IS_FOR_WEAKNESS (NAME_OF_WEAKNESS,NAME_OF_MEDICINE) values ('broken arm and achu','Not new medicine');
Insert into VLOD.MEDICINE_IS_FOR_WEAKNESS (NAME_OF_WEAKNESS,NAME_OF_MEDICINE) values ('broken leg','new leg');
Insert into VLOD.MEDICINE_IS_FOR_WEAKNESS (NAME_OF_WEAKNESS,NAME_OF_MEDICINE) values ('broken_arm','new_arm');
Insert into VLOD.MEDICINE_IS_FOR_WEAKNESS (NAME_OF_WEAKNESS,NAME_OF_MEDICINE) values ('really bad day sir','Not new medicine');
REM INSERTING into VLOD.SYNDROMES
SET DEFINE OFF;
Insert into VLOD.SYNDROMES (NAME_OF_SYNDROM) values ('Apchu');
Insert into VLOD.SYNDROMES (NAME_OF_SYNDROM) values ('NotPlanned');
Insert into VLOD.SYNDROMES (NAME_OF_SYNDROM) values ('arm is broken');
Insert into VLOD.SYNDROMES (NAME_OF_SYNDROM) values ('arm_is_broken');
Insert into VLOD.SYNDROMES (NAME_OF_SYNDROM) values ('leg is broken');
REM INSERTING into VLOD.TESTPCK
SET DEFINE OFF;
Insert into VLOD.TESTPCK (KEYPCK,VALUEPCK) values ('key1','val1');
Insert into VLOD.TESTPCK (KEYPCK,VALUEPCK) values ('key2','val2');
REM INSERTING into VLOD.USERSS
SET DEFINE OFF;
Insert into VLOD.USERSS (LOGIN,PASSWORD,USER_NAME,DATE_OF_BIRTH) values ('qqq1','2223','ItsNewName',to_date('13.01.2019','DD.MM.RRRR'));
Insert into VLOD.USERSS (LOGIN,PASSWORD,USER_NAME,DATE_OF_BIRTH) values ('expo1','4321','Ya Ya Yaa',to_date('04.10.2010','DD.MM.RRRR'));
Insert into VLOD.USERSS (LOGIN,PASSWORD,USER_NAME,DATE_OF_BIRTH) values ('expo12','1223','Ya Ya Ya4',to_date('04.08.2016','DD.MM.RRRR'));
Insert into VLOD.USERSS (LOGIN,PASSWORD,USER_NAME,DATE_OF_BIRTH) values ('expo123','122344',null,to_date('19.11.2018','DD.MM.RRRR'));
Insert into VLOD.USERSS (LOGIN,PASSWORD,USER_NAME,DATE_OF_BIRTH) values ('12223','1112223',null,to_date('17.12.2018','DD.MM.RRRR'));
Insert into VLOD.USERSS (LOGIN,PASSWORD,USER_NAME,DATE_OF_BIRTH) values ('eqeq','eqeq1','chotnekek',to_date('03.04.2018','DD.MM.RRRR'));
REM INSERTING into VLOD.WEAKNESS
SET DEFINE OFF;
Insert into VLOD.WEAKNESS (NAME_OF_WEAKNESS) values ('broken arm');
Insert into VLOD.WEAKNESS (NAME_OF_WEAKNESS) values ('broken arm and achu');
Insert into VLOD.WEAKNESS (NAME_OF_WEAKNESS) values ('broken leg');
Insert into VLOD.WEAKNESS (NAME_OF_WEAKNESS) values ('broken_arm');
Insert into VLOD.WEAKNESS (NAME_OF_WEAKNESS) values ('opgg');
Insert into VLOD.WEAKNESS (NAME_OF_WEAKNESS) values ('really bad day sir');
REM INSERTING into VLOD.WEAKNESS_HAS_SYNDROM
SET DEFINE OFF;
Insert into VLOD.WEAKNESS_HAS_SYNDROM (NAME_OF_SYNDROM,NAME_OF_WEAKNESS) values ('Apchu','broken arm and achu');
Insert into VLOD.WEAKNESS_HAS_SYNDROM (NAME_OF_SYNDROM,NAME_OF_WEAKNESS) values ('Apchu','really bad day sir');
Insert into VLOD.WEAKNESS_HAS_SYNDROM (NAME_OF_SYNDROM,NAME_OF_WEAKNESS) values ('arm is broken','broken arm');
Insert into VLOD.WEAKNESS_HAS_SYNDROM (NAME_OF_SYNDROM,NAME_OF_WEAKNESS) values ('arm is broken','broken arm and achu');
Insert into VLOD.WEAKNESS_HAS_SYNDROM (NAME_OF_SYNDROM,NAME_OF_WEAKNESS) values ('arm_is_broken','broken_arm');
Insert into VLOD.WEAKNESS_HAS_SYNDROM (NAME_OF_SYNDROM,NAME_OF_WEAKNESS) values ('leg is broken','broken leg');
--------------------------------------------------------
--  DDL for Index PK_USERSS
--------------------------------------------------------

  CREATE UNIQUE INDEX "VLOD"."PK_USERSS" ON "VLOD"."USERSS" ("LOGIN") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index PK_MEDICINE
--------------------------------------------------------

  CREATE UNIQUE INDEX "VLOD"."PK_MEDICINE" ON "VLOD"."MEDICINE" ("NAME_OF_MEDICINE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index UNIQUE_RECORD
--------------------------------------------------------

  CREATE UNIQUE INDEX "VLOD"."UNIQUE_RECORD" ON "VLOD"."HEALING_HISTORIES" ("LOGIN", "NAME_OF_WEAKNESS", "NAME_OF_MEDICINE", "NAME_OF_SYNDROM", "DATE_OF_DIAGNOSIS") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index PK_WEAKNESS_HAS_SYNDROM
--------------------------------------------------------

  CREATE UNIQUE INDEX "VLOD"."PK_WEAKNESS_HAS_SYNDROM" ON "VLOD"."WEAKNESS_HAS_SYNDROM" ("NAME_OF_SYNDROM", "NAME_OF_WEAKNESS") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index PK_MEDICINE_IS_FOR_WEAKNESS
--------------------------------------------------------

  CREATE UNIQUE INDEX "VLOD"."PK_MEDICINE_IS_FOR_WEAKNESS" ON "VLOD"."MEDICINE_IS_FOR_WEAKNESS" ("NAME_OF_WEAKNESS", "NAME_OF_MEDICINE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index PK_WEAKNESS
--------------------------------------------------------

  CREATE UNIQUE INDEX "VLOD"."PK_WEAKNESS" ON "VLOD"."WEAKNESS" ("NAME_OF_WEAKNESS") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index PK_SYNDROMES
--------------------------------------------------------

  CREATE UNIQUE INDEX "VLOD"."PK_SYNDROMES" ON "VLOD"."SYNDROMES" ("NAME_OF_SYNDROM") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Index PK_HEALING_HISTORIES
--------------------------------------------------------

  CREATE UNIQUE INDEX "VLOD"."PK_HEALING_HISTORIES" ON "VLOD"."HEALING_HISTORIES" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
--------------------------------------------------------
--  DDL for Trigger NO_FUTURE_BIRTH
--------------------------------------------------------

  CREATE OR REPLACE TRIGGER "VLOD"."NO_FUTURE_BIRTH" 
BEFORE INSERT OR UPDATE ON userss
FOR EACH ROW
BEGIN

    IF  :new.date_of_birth>TO_DATE(TO_CHAR(CURRENT_DATE), 'YYYY-MM-DD') THEN 

    raise_application_error(-20002,'No future dates allowed');

    END IF;
END;
/
ALTER TRIGGER "VLOD"."NO_FUTURE_BIRTH" DISABLE;
--------------------------------------------------------
--  DDL for Trigger NO_FUTURE_DATES
--------------------------------------------------------

  CREATE OR REPLACE TRIGGER "VLOD"."NO_FUTURE_DATES" 
BEFORE INSERT ON HEALING_HISTORIES
FOR EACH ROW
BEGIN

    IF  (:new.date_of_begin<TO_DATE(TO_CHAR(CURRENT_DATE), 'YYYY-MM-DD')) THEN 

    raise_application_error(-20002,'No future dates allowed');

    END IF;
END;
/
ALTER TRIGGER "VLOD"."NO_FUTURE_DATES" ENABLE;
--------------------------------------------------------
--  DDL for Trigger NO_HEAL_DELETE
--------------------------------------------------------

  CREATE OR REPLACE TRIGGER "VLOD"."NO_HEAL_DELETE" 
BEFORE DELETE ON HEALING_HISTORIES
FOR EACH ROW
BEGIN
    IF :old.date_of_end - TO_DATE(TO_CHAR(CURRENT_DATE), 'YYYY-MM-DD') > 3 THEN 

    raise_application_error(-20001,'Records can not be deleted');

    END IF;
END;
/
ALTER TRIGGER "VLOD"."NO_HEAL_DELETE" ENABLE;
--------------------------------------------------------
--  DDL for Procedure CUSTUSE
--------------------------------------------------------
set define off;

  CREATE OR REPLACE PROCEDURE "VLOD"."CUSTUSE" 
IS
cursor fstcurs is
SELECT cust_id, cust_name FROM customers;
c_cou fstcurs%rowtype;
BEGIN
FOR c_cou IN fstcurs
LOOP

dbms_output.put_line(c_cou.cust_id ||'  '|| c_cou.cust_name);
END LOOP;
END custuse;

/
--------------------------------------------------------
--  DDL for Procedure PROCEDURE1
--------------------------------------------------------
set define off;

  CREATE OR REPLACE PROCEDURE "VLOD"."PROCEDURE1" 
(
  PARAM1 OUT VARCHAR2 
, PARAM2 IN VARCHAR2 
, PARAM3 IN VARCHAR2 
) AS 
BEGIN

END PROCEDURE1;

/
--------------------------------------------------------
--  DDL for Procedure TESTINOUT
--------------------------------------------------------
set define off;

  CREATE OR REPLACE PROCEDURE "VLOD"."TESTINOUT" (NUM IN OUT NUMBER, countr OUT VARCHAR2)
IS

BEGIN

	SELECT cust_state INTO countr FROM customers
	WHERE customers.cust_id = NUM;

	SELECT cust_zip INTO NUM FROM customers
	WHERE customers.cust_id = NUM;

END TESTINOUT;

/
--------------------------------------------------------
--  DDL for Package DIAG
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VLOD"."DIAG" 
IS
function upd_diag(nm diagnosis.diag%type, new_nm diagnosis.diag%type)
return integer;

end diag;

/
--------------------------------------------------------
--  DDL for Package HEAL_HIST
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VLOD"."HEAL_HIST" IS


TYPE histRec is record(
wek weakness.name_of_weakness%type,
med medicine.name_of_medicine%type,
syn syndromes.name_of_syndrom%type,
diag date,
beg date,
en date);
TYPE histTbl is table of histRec;



TYPE medStat is record(
med medicine.name_of_medicine%type,
numbs number);
TYPE medStatTbl is table of medStat;

TYPE wekStat is record(
wek weakness.name_of_weakness%type,
numbs number);
TYPE wekStatTbl is table of wekStat;





function new_record(logs healing_histories.login%type, 
wek weakness.name_of_weakness%type,
med medicine.name_of_medicine%type,
syn syndromes.name_of_syndrom%type,
diag date,
beg date,
en date) 
return integer;

function del_record(logs healing_histories.login%type, 
wek weakness.name_of_weakness%type,
med medicine.name_of_medicine%type,
syn syndromes.name_of_syndrom%type,
diag date,
beg date,
en date) 
return integer;

function stat_meds_for_wek(wek weakness.name_of_weakness%type)
return medStatTbl
PIPELINED;

function stat_wek_for_syn(syn syndromes.name_of_syndrom%type)
return wekStatTbl
PIPELINED;

function user_history(logs healing_histories.login%type)
return histTbl
PIPELINED;



end heal_hist;

/
--------------------------------------------------------
--  DDL for Package MED_FOR_WEAK
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VLOD"."MED_FOR_WEAK" IS
TYPE wekRec is record(
wek weakness.name_of_weakness%type);
TYPE tblWekSet is table of wekRec;
TYPE medRec is record(
med medicine.name_of_medicine%type);
TYPE tblMedSet is table of medRec;
TYPE mwRec is record(
med medicine.name_of_medicine%type,
wek weakness.name_of_weakness%type
);
type tblMwSet is table of mwRec;

FUNCTION new_record(med medicine.name_of_medicine%type, wek weakness.name_of_weakness%type)
    Return integer;

FUNCTION del_record(med medicine.name_of_medicine%type, wek weakness.name_of_weakness%type)
    Return integer;

function list_weaks_by_medicine(med medicine.name_of_medicine%type)
return tblWekSet
PIPELINED;

function list_medicine_by_weak(wek weakness.name_of_weakness%type)
return tblMedSet
PIPELINED;

function list_med_for_weak_tbl
return tblMwSet
PIPELINED;
END med_for_weak;

/
--------------------------------------------------------
--  DDL for Package MEDS
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VLOD"."MEDS" IS
TYPE medRec is record(
med medicine.name_of_medicine%type);
TYPE tblMedSet is table of medRec;

FUNCTION new_med(med medicine.name_of_medicine%type)
    Return integer;

FUNCTION del_med(med medicine.name_of_medicine%type)
    Return integer;

Function upd_med(med medicine.name_of_medicine%type, new_med medicine.name_of_medicine%type)
return integer;

function list_meds
return tblMedSet
PIPELINED;
END meds;

/
--------------------------------------------------------
--  DDL for Package MWS
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VLOD"."MWS" IS


TYPE medRec IS RECORD(

    med medicine.name_of_medicine%TYPE

);
TYPE wekRec IS RECORD(

    wek weakness.name_of_weakness%TYPE

);
TYPE synRec IS RECORD(

    syn syndromes.name_of_syndrom%TYPE

);

TYPE wekSynRec IS RECORD(

    syn syndromes.name_of_syndrom%TYPE,
    wek weakness.name_of_weakness%TYPE

);

TYPE medWekRec IS RECORD(

    med medicine.name_of_medicine%TYPE,
    wek weakness.name_of_weakness%TYPE

);

---------------------------------------------------------------------------------

TYPE tblWekSet IS TABLE OF wekRec;
TYPE tblMedSet IS TABLE OF medRec;
TYPE tblSynSet IS TABLE OF synRec;
TYPE medWekSet IS TABLE OF medWekRec;
TYPE wekSynSet IS TABLE OF wekSynRec;

------------------------------------------------------------------------------------------

FUNCTION del_weakness (wek weakness.name_of_weakness%TYPE)

    RETURN INTEGER;

FUNCTION del_medicine (med medicine.name_of_medicine%TYPE)

    RETURN INTEGER;

FUNCTION del_syndrom (syn syndromes.name_of_syndrom%TYPE)

    RETURN INTEGER;

FUNCTION del_wek_syn (syn syndromes.name_of_syndrom%TYPE, wek weakness.name_of_weakness%TYPE)

    RETURN INTEGER;

FUNCTION del_med_wek (med medicine.name_of_medicine%TYPE, wek weakness.name_of_weakness%TYPE)

    RETURN INTEGER;

------------------------------------------------------------------------------------------------

FUNCTION upd_weakness (wek weakness.name_of_weakness%TYPE)

    RETURN INTEGER;

FUNCTION upd_medicine (med medicine.name_of_medicine%TYPE)

    RETURN INTEGER;

FUNCTION upd_syndrom (syn syndromes.name_of_syndrom%TYPE)

    RETURN INTEGER;

FUNCTION upd_wek_syn (syn syndromes.name_of_syndrom%TYPE, wek weakness.name_of_weakness%TYPE)

    RETURN INTEGER;

FUNCTION upd_med_wek (med medicine.name_of_medicine%TYPE, wek weakness.name_of_weakness%TYPE)

    RETURN INTEGER;

------------------------------------------------------------------------------------------------

FUNCTION new_weakness (wek weakness.name_of_weakness%TYPE)

    RETURN INTEGER;

FUNCTION new_medicine (med medicine.name_of_medicine%TYPE)

    RETURN INTEGER;

FUNCTION new_syndrom (syn syndromes.name_of_syndrom%TYPE)

    RETURN INTEGER;

FUNCTION new_wek_syn (syn syndromes.name_of_syndrom%TYPE, wek weakness.name_of_weakness%TYPE)

    RETURN INTEGER;

FUNCTION new_med_wek (med medicine.name_of_medicine%TYPE, wek weakness.name_of_weakness%TYPE)

    RETURN INTEGER;

------------------------------------------------------------------------------------------------

FUNCTION get_wek_syndromes (wek weakness.name_of_weakness%TYPE)

    RETURN tblSynSet
    PIPELINED;

FUNCTION get_syn_weakss (syn syndromes.name_of_syndrom%TYPE)

    RETURN tblWekSet
    PIPELINED;

FUNCTION get_wek_meds (wek weakness.name_of_weakness%TYPE)

    RETURN tblMedSet
    PIPELINED;

FUNCTION get_med_weakss (med medicine.name_of_medicine%TYPE)

    RETURN tblWekSet
    PIPELINED;

END MWS;

/
--------------------------------------------------------
--  DDL for Package P_MY1
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VLOD"."P_MY1" IS



TYPE testrec IS RECORD(

    keyq testpck.keypck%TYPE,

    valq testpck.valuepck%TYPE

);

TYPE tblGetTicket IS TABLE OF testrec;

FUNCTION value_by_key (keyq IN testpck.keypck%TYPE)

    RETURN tblGetTicket

    PIPELINED;

END P_MY1;

/
--------------------------------------------------------
--  DDL for Package SYND
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VLOD"."SYND" IS
TYPE synRec is record(
syn syndromes.name_of_syndrom%type);
TYPE tblSynSet is table of synRec;

FUNCTION new_synd(syn syndromes.name_of_syndrom%type)
    Return integer;

FUNCTION del_synd(syn syndromes.name_of_syndrom%type)
    Return integer;

Function upd_synd(syn syndromes.name_of_syndrom%type, new_syn syndromes.name_of_syndrom%type)
return integer;

function list_syndromes
return tblSynSet
PIPELINED;
END synd;

/
--------------------------------------------------------
--  DDL for Package USER_PACK
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VLOD"."USER_PACK" IS


    TYPE user_logpas IS RECORD(

    logs userss.login%TYPE,

    pass userss.password%TYPE
);


TYPE userRec IS RECORD(

    logs userss.login%TYPE,

    pass userss.password%TYPE,

    u_name userss.user_name%TYPE,

    u_birth userss.date_of_birth%TYPE

);

TYPE tblUserSet IS TABLE OF userRec;

FUNCTION del_user (logs IN userss.login%TYPE, pass IN userss.password%Type)

    RETURN INTEGER;

FUNCTION upd_user_pass (logs IN userss.login%TYPE, old_pass IN userss.password%TYPE, new_pass IN userss.password%TYPE)

    RETURN INTEGER;

FUNCTION upd_user_name (logs IN userss.login%TYPE, u_name IN userss.user_name%TYPE)

    RETURN INTEGER;

FUNCTION upd_user_birth (logs IN userss.login%TYPE, u_birth IN userss.date_of_birth%TYPE)

    RETURN INTEGER;

FUNCTION new_user (logs IN userss.login%TYPE, pass IN userss.password%TYPE)

    RETURN INTEGER;

FUNCTION get_user (logs IN userss.login%TYPE)

    RETURN userRec;

FUNCTION loginin (logs IN userss.login%type, pass IN userss.password%type)

    RETURN INT;

FUNCTION user_list (u_name IN USERSS.user_name%type)

    RETURN tblUserSet
    PIPELINED ;

END USER_PACK;

/
--------------------------------------------------------
--  DDL for Package WEAK_HAS_SYND
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VLOD"."WEAK_HAS_SYND" IS
TYPE wekRec is record(
wek weakness.name_of_weakness%type);
TYPE tblWekSet is table of wekRec;
TYPE synRec is record(
syn syndromes.name_of_syndrom%type);
TYPE tblSynSet is table of synRec;
TYPE wsRec is record(

wek weakness.name_of_weakness%type,
syn syndromes.name_of_syndrom%type
);
type tblWsSet is table of wsRec;

FUNCTION new_record(wek weakness.name_of_weakness%type, syn syndromes.name_of_syndrom%type)
    Return integer;

FUNCTION del_record(wek weakness.name_of_weakness%type, syn syndromes.name_of_syndrom%type)
    Return integer;

function list_weaks_by_syndrom(syn syndromes.name_of_syndrom%type)
return tblWekSet
PIPELINED;

function list_syns_by_weak(wek weakness.name_of_weakness%type)
return tblSynSet
PIPELINED;

function list_weak_with_synd_tbl
return tblWsSet
PIPELINED;
END weak_has_synd;

/
--------------------------------------------------------
--  DDL for Package WEAKS
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "VLOD"."WEAKS" IS
TYPE wekRec is record(
wek weakness.name_of_weakness%type);
TYPE tblWekSet is table of wekRec;

FUNCTION new_weak(wek weakness.name_of_weakness%type)
    Return integer;

FUNCTION del_weak(wek weakness.name_of_weakness%type)
    Return integer;

Function upd_weak(wek weakness.name_of_weakness%type, new_wek weakness.name_of_weakness%type)
return integer;

function list_weaks
return tblWekSet
PIPELINED;
END weaks;

/
--------------------------------------------------------
--  DDL for Package Body DIAG
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE BODY "VLOD"."DIAG" 
IS

function upd_diag(nm diagnosis.diag%type, new_nm diagnosis.diag%type)
return integer
IS
begin
UPDATE diagnosis SET diag=new_nm where diag=nm;
commit;
return 0;
EXCEPTION
WHEN OTHERS THEN
rollback;
return -1;
end;

end diag;

/
--------------------------------------------------------
--  DDL for Package Body HEAL_HIST
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE BODY "VLOD"."HEAL_HIST" IS


function new_record(logs healing_histories.login%type, 
wek weakness.name_of_weakness%type,
med medicine.name_of_medicine%type,
syn syndromes.name_of_syndrom%type,
diag date,
beg date,
en date) 
return integer
is
chw number;
begin
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
select max(id) into chw from healing_histories;
insert into healing_histories(id, login, name_of_weakness, name_of_medicine, name_of_syndrom, date_of_diagnosis, date_of_begin, date_of_end)  values (chw+1, logs, wek, med, syn, diag, beg, en);
commit;
return 0;
exception
when others then
rollback;
return -1;
end new_record;



function del_record(logs healing_histories.login%type, 
wek weakness.name_of_weakness%type,
med medicine.name_of_medicine%type,
syn syndromes.name_of_syndrom%type,
diag date,
beg date,
en date) 
return integer
is 
begin
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
delete from healing_histories where (name_of_weakness = wek OR name_of_weakness is null) and (name_of_medicine = med or name_of_medicine is null) and login = logs and (name_of_syndrom = syn or name_of_syndrom is null) and date_of_diagnosis = diag and (date_of_begin = beg or date_of_begin is null) and (date_of_end = en or date_of_end is null);
commit;
return 0;
EXCEPTION
WHEN OTHERS THEN
rollback;
return 1;
end del_record;

function stat_meds_for_wek(wek weakness.name_of_weakness%type)
return medStatTbl
PIPELINED
IS
cursor tmp_cur is
select name_of_medicine, count(*) from healing_histories where name_of_weakness = wek group by name_of_medicine;
BEGIN
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in tmp_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;


END stat_meds_for_wek;

function stat_wek_for_syn(syn syndromes.name_of_syndrom%type)
return wekStatTbl
PIPELINED
IS
cursor tmp_cur is
select name_of_weakness, count(*) from healing_histories where name_of_syndrom = syn group by name_of_weakness;
BEGIN
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in tmp_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;
    end stat_wek_for_syn;

function user_history(logs healing_histories.login%type)
return histTbl
PIPELINED
IS
cursor tmp_cur is
select name_of_weakness, name_of_medicine, name_of_syndrom, date_of_diagnosis, date_of_begin, date_of_end from healing_histories where healing_histories.login = logs order by date_of_diagnosis;
BEGIN
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in tmp_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;
    end user_history;




end heal_hist;

/
--------------------------------------------------------
--  DDL for Package Body MED_FOR_WEAK
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE BODY "VLOD"."MED_FOR_WEAK" IS


FUNCTION new_record(med medicine.name_of_medicine%type, wek weakness.name_of_weakness%type)
    Return integer
    Is
chw number;
ch1 number;
ch2 number;
BEGIN
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
SELECT count(*) into chw from medicine_is_for_weakness where name_of_medicine = med and name_of_weakness = wek;
SELECT count(*) into ch1 from medicine where name_of_medicine=med;
SELECT count(*) into ch2 from weakness where name_of_weakness=wek;
if chw = 0 and ch1!=0 and ch2!=0 then
insert into medicine_is_for_weakness(name_of_weakness, name_of_medicine)  values (wek, med);
COMMIT;
return 0;
else 
ROLLBACK;
return 1;
end if;
EXCEPTION
WHEN OTHERS THEN
ROLLBACK;
return -1;
    end new_record;

FUNCTION del_record(med medicine.name_of_medicine%type, wek weakness.name_of_weakness%type)
    Return integer
        is
    ch1 number;
    ch2 number;
 begin
 SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
 select count(*) into ch1 from healing_histories where healing_histories.name_of_medicine = med and healing_histories.name_of_weakness = wek;
 if ch1 = 0 then return 1;
 else 
delete from medicine_is_for_weakness where name_of_weakness = wek and name_of_medicine = med;
COMMIT;
return 0;
end if;
EXCEPTION
WHEN OTHERS THEN
ROLLBACK;
return -1;
end del_record;



function list_weaks_by_medicine(med medicine.name_of_medicine%type)
return tblWekSet
PIPELINED
is
cursor tmp_cur is
select name_of_weakness from medicine_is_for_weakness where name_of_medicine = med;
begin
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in tmp_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;
end list_weaks_by_medicine;



function list_medicine_by_weak(wek weakness.name_of_weakness%type)
return tblMedSet
PIPELINED
is
cursor tmp_cur is
select name_of_medicine from medicine_is_for_weakness where name_of_weakness = wek;
begin
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in tmp_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;

    end list_medicine_by_weak;



function list_med_for_weak_tbl
return tblMwSet
PIPELINED
is
cursor tmp_cur is
select name_of_medicine, name_of_weakness from medicine_is_for_weakness;
begin
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in tmp_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;
    end list_med_for_weak_tbl;


END med_for_weak;

/
--------------------------------------------------------
--  DDL for Package Body MEDS
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE BODY "VLOD"."MEDS" IS


FUNCTION new_med(med medicine.name_of_medicine%type)
return integer
IS
chw number;
BEGIN
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
SELECT count(*) into chw from medicine where name_of_medicine=med;
if chw = 0 then
insert into medicine values (med);
COMMIT;
return 0;
ROLLBACK;
else return 1;

end if;
EXCEPTION
WHEN OTHERS THEN
ROLLBACK;
return -1;
END new_med;



FUNCTION del_med(med medicine.name_of_medicine%type)
    Return integer
    is
    ch1 number;
    ch2 number;
 begin
 SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
 select count(*) into ch1 from healing_histories where healing_histories.name_of_medicine = med;
 if ch1 != 0 then return 1;
 else 
delete from medicine_is_for_weakness where name_of_medicine = med;
delete from medicine where name_of_medicine = med;
COMMIT;
return 0;
end if;
EXCEPTION
WHEN OTHERS THEN
ROLLBACK;
return -1;
end del_med;


Function upd_med(med medicine.name_of_medicine%type, new_med medicine.name_of_medicine%type)
return integer

is
begin
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
EXECUTE IMMEDIATE 'ALTER TABLE healing_histories disable constraint FK_HEALING__USED_MEDI';
EXECUTE IMMEDIATE 'ALTER TABLE medicine_is_for_weakness disable constraint FK_MEDICINE_MEDICINE__MEDICINE';
update medicine set name_of_medicine = new_med where name_of_medicine = med;
update medicine_is_for_weakness set name_of_medicine = new_med where name_of_medicine = med;
update healing_histories set name_of_medicine = new_med where name_of_medicine = med;
EXECUTE IMMEDIATE 'ALTER TABLE healing_histories enable constraint FK_HEALING__USED_MEDI';
EXECUTE IMMEDIATE 'ALTER TABLE medicine_is_for_weakness enable constraint FK_MEDICINE_MEDICINE__MEDICINE';
commit;
return 0;
exception 
when others then
rollback;
return -1;
end upd_med;



function list_meds
return tblMedSet
PIPELINED
is
cursor med_cur is
select name_of_medicine from medicine;
begin
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

    FOR curr in med_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;
end list_meds;
END meds;

/
--------------------------------------------------------
--  DDL for Package Body MWS
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE BODY "VLOD"."MWS" IS

FUNCTION del_weakness (wek weakness.name_of_weakness%TYPE)

    RETURN INTEGER
    IS
    BEGIN
    IF wek IN (select name_of_weakness from weakness) THEN 
    delete from weakness where name_of_weakness = wek;
    return 0;
    ELSE
    return 1;
    END IF;


end del_weakness;



END MWS;

/
--------------------------------------------------------
--  DDL for Package Body P_MY1
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE BODY "VLOD"."P_MY1" IS
FUNCTION value_by_key (keyq IN testpck.keypck%TYPE)

    RETURN tblGetTicket

    PIPELINED
    IS
        CURSOR MY_CUR IS 
            SELECT keypck, valuepck FROM testpck
            where keypck = keyq;
    BEGIN
    FOR curr in MY_CUR 
    LOOP
        PIPE ROW(curr);
    END LOOP;
    end value_by_key;

END P_MY1;

/
--------------------------------------------------------
--  DDL for Package Body SYND
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE BODY "VLOD"."SYND" IS

FUNCTION new_synd(syn syndromes.name_of_syndrom%type)
return integer
IS
chw number;
BEGIN
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
SELECT count(*) into chw from syndromes where name_of_syndrom=syn;
if chw = 0 then
insert into syndromes  values (syn);
COMMIT;
return 0;
else 
ROLLBACK;
return 1;
end if;
EXCEPTION
WHEN OTHERS THEN
ROLLBACK;
return -1;
END new_synd;



FUNCTION del_synd(syn syndromes.name_of_syndrom%type)
    Return integer
    is
    ch1 number;
    ch2 number;
 begin
 SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
 select count(*) into ch1 from healing_histories where healing_histories.name_of_syndrom = syn;
 if ch1 != 0 then return 1;
 else 
delete from weakness_has_syndrom where name_of_syndrom = syn;
delete from syndromes where name_of_syndrom = syn;
COMMIT;
return 0;
end if;
EXCEPTION
WHEN OTHERS THEN
ROLLBACK;
return -1;
end del_synd;

Function upd_synd(syn syndromes.name_of_syndrom%type, new_syn syndromes.name_of_syndrom%type)
return integer
is
begin
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
EXECUTE IMMEDIATE 'ALTER TABLE healing_histories disable constraint FK_HEALING__SYNDROMES_SYNDROME';
EXECUTE IMMEDIATE 'ALTER TABLE weakness_has_syndrom disable constraint FK_WEAKNESS_WEAKNESS__SYNDROME';
update syndromes set name_of_syndrom = new_syn where name_of_syndrom = syn ;
update weakness_has_syndrom set name_of_syndrom = new_syn where name_of_syndrom = syn ;
update healing_histories set name_of_syndrom = new_syn where name_of_syndrom = syn ;
EXECUTE IMMEDIATE 'ALTER TABLE healing_histories enable constraint FK_HEALING__SYNDROMES_SYNDROME';
EXECUTE IMMEDIATE 'ALTER TABLE weakness_has_syndrom enable constraint FK_WEAKNESS_WEAKNESS__SYNDROME';
commit;
return 0;
exception 
when others then
rollback;
return -1;
end upd_synd;

function list_syndromes
return tblSynSet
PIPELINED
is
cursor syn_cur is
select name_of_syndrom from syndromes;
begin
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in syn_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;
end list_syndromes;
END synd;

/
--------------------------------------------------------
--  DDL for Package Body USER_PACK
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE BODY "VLOD"."USER_PACK" IS
FUNCTION del_user (logs IN userss.login%TYPE, pass IN userss.password%Type)

    RETURN INTEGER
    IS

    checks user_logpas;
    BEGIN
    SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
    SELECT LOGIN, PASSWORD INTO checks FROM USERSS WHERE login = logs;
    IF checks.logs is NULL then return 1; END IF;
    IF checks.pass != pass then return 2; END IF;
    delete from userss where login = logs;
    return 0;

end del_user;

FUNCTION upd_user_pass (logs IN userss.login%TYPE, old_pass IN userss.password%TYPE, new_pass IN userss.password%TYPE)

    RETURN INTEGER
    IS
    checks user_logpas;
    BEGIN
    SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    SELECT LOGIN, PASSWORD INTO checks FROM userss where login=logs;
    IF checks.logs is NULL then return 1; END IF;
    IF new_pass = old_pass then return 2; end if;
    if checks.pass != old_pass then return 2; end if;
    UPDATE USERSS SET password = new_pass WHERE login = logs;
    return 0;
    END upd_user_pass;

FUNCTION upd_user_name (logs IN userss.login%TYPE, u_name IN userss.user_name%TYPE)

    RETURN INTEGER
    IS
    checks userss.login%TYPE;
    BEGIN
    SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    SELECT LOGIN INTO checks FROM userss where login=logs;
    IF checks is NULL then return 1; END IF;
    UPDATE USERSS SET user_name = u_name WHERE login = logs;
    return 0;
    END upd_user_name;

FUNCTION upd_user_birth (logs IN userss.login%TYPE, u_birth IN userss.date_of_birth%TYPE)

    RETURN INTEGER
    IS
    checks userss.login%TYPE;
    BEGIN
    SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    SELECT LOGIN INTO checks FROM userss where login=logs;
    IF checks is NULL then return 1; END IF;
    UPDATE USERSS SET date_of_birth = u_birth WHERE login = logs;
    return 0;
    END upd_user_birth;


FUNCTION new_user (logs IN userss.login%TYPE, pass IN userss.password%TYPE)

    RETURN INTEGER
        IS
    checks userss.login%TYPE;
    BEGIN
    SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
    SELECT LOGIN INTO checks FROM userss where login=logs;
    IF checks is NOT NULL then return 1; END IF;

    EXCEPTION 
    WHEN no_data_found THEN
    INSERT INTO USERSS(login, password, date_of_birth) VALUES (logs, pass, sysdate);
    return 0;

    END new_user;

FUNCTION get_user (logs IN userss.login%TYPE)

    RETURN userRec
    IS
    res userRec;
    BEGIN
    SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    SELECT LOGIN ,
PASSWORD ,
USER_NAME ,
DATE_OF_BIRTH  INTO res FROM USERSS WHERE login = logs;
return res;
    END get_user;

FUNCTION loginin (logs IN userss.login%type, pass IN userss.password%type)

    RETURN INT
    IS
    checks user_logpas;
    BEGIN
    SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    SELECT LOGIN , PASSWORD   INTO checks FROM USERSS WHERE login = logs;
    IF(checks.logs = logs) AND (checks.pass = pass) THEN return 1; ELSE return  2  ; END IF;
END loginin;

FUNCTION user_list (u_name IN USERSS.user_name%type)

    RETURN tblUserSet

    PIPELINED 
    IS
    CURSOR u_cur IS 
    SELECT LOGIN , PASSWORD , USER_NAME , DATE_OF_BIRTH  FROM  USERSS WHERE user_name = u_name;
    BEGIN 
    SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in u_cur 
    LOOP
        PIPE ROW(curr);
    END LOOP;
    END user_list;


END USER_PACK;

/
--------------------------------------------------------
--  DDL for Package Body WEAK_HAS_SYND
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE BODY "VLOD"."WEAK_HAS_SYND" IS


FUNCTION new_record(wek weakness.name_of_weakness%type, syn syndromes.name_of_syndrom%type)
    Return integer
    Is
chw number;
ch1 number;
ch2 number;
BEGIN
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
SELECT count(*) into chw from weakness_has_syndrom where name_of_syndrom = syn and name_of_weakness = wek;
SELECT count(*) into ch1 from syndromes where name_of_syndrom=syn;
SELECT count(*) into ch2 from weakness where name_of_weakness=wek;
if chw = 0 and ch1!=0 and ch2!=0 then
insert into weakness_has_syndrom(name_of_weakness, name_of_syndrom)  values (wek, syn);
COMMIT;
return 0;
else 
ROLLBACK;
return 1;
end if;
EXCEPTION
WHEN OTHERS THEN
ROLLBACK;
return -1;
    end new_record;

FUNCTION del_record(wek weakness.name_of_weakness%type, syn syndromes.name_of_syndrom%type)
    Return integer
        is
    ch1 number;
    ch2 number;
 begin
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
delete from weakness_has_syndrom where name_of_weakness = wek and name_of_syndrom = syn;
COMMIT;
return 0;
EXCEPTION
WHEN OTHERS THEN
ROLLBACK;
return -1;
end del_record;



function list_weaks_by_syndrom(syn syndromes.name_of_syndrom%type)
return tblWekSet
PIPELINED
is
cursor tmp_cur is
select name_of_weakness from weakness_has_syndrom where name_of_syndrom = syn;
begin
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in tmp_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;
end list_weaks_by_syndrom;



function list_syns_by_weak(wek weakness.name_of_weakness%type)
return tblSynSet
PIPELINED
is
cursor tmp_cur is
select name_of_syndrom from weakness_has_syndrom where name_of_weakness = wek;
begin
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in tmp_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;
    end list_syns_by_weak;



function list_weak_with_synd_tbl
return tblWsSet
PIPELINED
is
cursor tmp_cur is
select name_of_syndrom, name_of_weakness from weakness_has_syndrom;
begin
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in tmp_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;
    end list_weak_with_synd_tbl;


END weak_has_synd;

/
--------------------------------------------------------
--  DDL for Package Body WEAKS
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE BODY "VLOD"."WEAKS" IS

FUNCTION new_weak(wek weakness.name_of_weakness%type)
    Return integer
    is
    chw number;
BEGIN
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
SELECT count(*) into chw from weakness where name_of_weakness=wek;
if chw = 0 then
insert into weakness values (wek);
COMMIT;
return 0;
ROLLBACK;
else return 1;

end if;
EXCEPTION
WHEN OTHERS THEN
ROLLBACK;
return -1;
END new_weak;

FUNCTION del_weak(wek weakness.name_of_weakness%type)
    Return integer
    is
    ch1 number;
    ch2 number;
 begin
 SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
 select count(*) into ch1 from healing_histories where healing_histories.name_of_weakness = wek;
 if ch1 != 0 then return 1;
 else 
delete from medicine_is_for_weakness where name_of_weakness = wek;
delete from weakness_has_syndrom where name_of_weakness = wek;
delete from weakness where name_of_weakness = wek;
COMMIT;
return 0;
end if;
EXCEPTION
WHEN OTHERS THEN
ROLLBACK;
return -1;
end del_weak;


Function upd_weak(wek weakness.name_of_weakness%type, new_wek weakness.name_of_weakness%type)
return integer
is
begin
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
EXECUTE IMMEDIATE 'ALTER TABLE healing_histories disable constraint FK_HEALING__SYNDROMES_SYNDROME';
EXECUTE IMMEDIATE 'ALTER TABLE healing_histories disable constraint FK_HEALING__USED_MEDI';
EXECUTE IMMEDIATE 'ALTER TABLE medicine_is_for_weakness disable constraint FK_MEDICINE_WEAKNESSS_WEAKNESS';
EXECUTE IMMEDIATE 'ALTER TABLE weakness_has_syndrom disable constraint FK_WEAKNESS_WEAKNESS__WEAKNESS';
update weakness set name_of_weakness = new_wek where name_of_weakness = wek;
update medicine_is_for_weakness set name_of_weakness = new_wek where name_of_weakness = wek;
update weakness_has_syndrom set name_of_weakness = new_wek where name_of_weakness=wek;
update healing_histories set name_of_weakness = new_wek where name_of_weakness = wek;
EXECUTE IMMEDIATE 'ALTER TABLE healing_histories enable constraint FK_HEALING__SYNDROMES_SYNDROME';
EXECUTE IMMEDIATE 'ALTER TABLE healing_histories enable constraint FK_HEALING__USED_MEDI';
EXECUTE IMMEDIATE 'ALTER TABLE medicine_is_for_weakness enable constraint FK_MEDICINE_WEAKNESSS_WEAKNESS';
EXECUTE IMMEDIATE 'ALTER TABLE weakness_has_syndrom enable constraint FK_WEAKNESS_WEAKNESS__WEAKNESS';
commit;
return 0;
exception when others then
rollback;
return -1;
end upd_weak;



function list_weaks
return tblWekSet
PIPELINED
is
cursor wek_cur is
select name_of_weakness from weakness;
begin
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    FOR curr in wek_cur
    LOOP
        PIPE ROW(curr);
    END LOOP;
end list_weaks;
END weaks;

/
--------------------------------------------------------
--  Constraints for Table SYNDROMES
--------------------------------------------------------

  ALTER TABLE "VLOD"."SYNDROMES" ADD CONSTRAINT "REG_FOR_SYNDROM_NAME" CHECK (REGEXP_LIKE(name_of_syndrom, '[A-Za-z0-9\s]{1,20}')) ENABLE;
  ALTER TABLE "VLOD"."SYNDROMES" ADD CONSTRAINT "PK_SYNDROMES" PRIMARY KEY ("NAME_OF_SYNDROM")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "VLOD"."SYNDROMES" MODIFY ("NAME_OF_SYNDROM" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table WEAKNESS_HAS_SYNDROM
--------------------------------------------------------

  ALTER TABLE "VLOD"."WEAKNESS_HAS_SYNDROM" ADD CONSTRAINT "PK_WEAKNESS_HAS_SYNDROM" PRIMARY KEY ("NAME_OF_SYNDROM", "NAME_OF_WEAKNESS")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "VLOD"."WEAKNESS_HAS_SYNDROM" MODIFY ("NAME_OF_WEAKNESS" NOT NULL ENABLE);
  ALTER TABLE "VLOD"."WEAKNESS_HAS_SYNDROM" MODIFY ("NAME_OF_SYNDROM" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table MEDICINE_IS_FOR_WEAKNESS
--------------------------------------------------------

  ALTER TABLE "VLOD"."MEDICINE_IS_FOR_WEAKNESS" ADD CONSTRAINT "PK_MEDICINE_IS_FOR_WEAKNESS" PRIMARY KEY ("NAME_OF_WEAKNESS", "NAME_OF_MEDICINE")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "VLOD"."MEDICINE_IS_FOR_WEAKNESS" MODIFY ("NAME_OF_MEDICINE" NOT NULL ENABLE);
  ALTER TABLE "VLOD"."MEDICINE_IS_FOR_WEAKNESS" MODIFY ("NAME_OF_WEAKNESS" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table HEALING_HISTORIES
--------------------------------------------------------

  ALTER TABLE "VLOD"."HEALING_HISTORIES" ADD CONSTRAINT "PK_HEALING_HISTORIES" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "VLOD"."HEALING_HISTORIES" ADD CONSTRAINT "UNIQUE_RECORD" UNIQUE ("LOGIN", "NAME_OF_WEAKNESS", "NAME_OF_MEDICINE", "NAME_OF_SYNDROM", "DATE_OF_DIAGNOSIS")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "VLOD"."HEALING_HISTORIES" MODIFY ("DATE_OF_DIAGNOSIS" NOT NULL ENABLE);
  ALTER TABLE "VLOD"."HEALING_HISTORIES" MODIFY ("LOGIN" NOT NULL ENABLE);
  ALTER TABLE "VLOD"."HEALING_HISTORIES" MODIFY ("ID" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table WEAKNESS
--------------------------------------------------------

  ALTER TABLE "VLOD"."WEAKNESS" ADD CONSTRAINT "REG_FOR_WEAKNESS_NAME" CHECK (REGEXP_LIKE(name_of_weakness, '[A-Za-z0-9\s]{1,20}')) ENABLE;
  ALTER TABLE "VLOD"."WEAKNESS" ADD CONSTRAINT "PK_WEAKNESS" PRIMARY KEY ("NAME_OF_WEAKNESS")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "VLOD"."WEAKNESS" MODIFY ("NAME_OF_WEAKNESS" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table MEDICINE
--------------------------------------------------------

  ALTER TABLE "VLOD"."MEDICINE" ADD CONSTRAINT "REG_FOR_MEDICINE_NAME" CHECK (REGEXP_LIKE(name_of_medicine, '[A-Za-z0-9\s]{1,20}')) ENABLE;
  ALTER TABLE "VLOD"."MEDICINE" ADD CONSTRAINT "PK_MEDICINE" PRIMARY KEY ("NAME_OF_MEDICINE")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "VLOD"."MEDICINE" MODIFY ("NAME_OF_MEDICINE" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table USERSS
--------------------------------------------------------

  ALTER TABLE "VLOD"."USERSS" ADD CONSTRAINT "PK_USERSS" PRIMARY KEY ("LOGIN")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "VLOD"."USERSS" MODIFY ("DATE_OF_BIRTH" NOT NULL ENABLE);
  ALTER TABLE "VLOD"."USERSS" MODIFY ("PASSWORD" NOT NULL ENABLE);
  ALTER TABLE "VLOD"."USERSS" MODIFY ("LOGIN" NOT NULL ENABLE);
--------------------------------------------------------
--  Ref Constraints for Table HEALING_HISTORIES
--------------------------------------------------------

  ALTER TABLE "VLOD"."HEALING_HISTORIES" ADD CONSTRAINT "FK_HEALING__SYNDROMES_SYNDROME" FOREIGN KEY ("NAME_OF_SYNDROM")
	  REFERENCES "VLOD"."SYNDROMES" ("NAME_OF_SYNDROM") ENABLE;
  ALTER TABLE "VLOD"."HEALING_HISTORIES" ADD CONSTRAINT "FK_HEALING__USED_MEDI" FOREIGN KEY ("NAME_OF_WEAKNESS", "NAME_OF_MEDICINE")
	  REFERENCES "VLOD"."MEDICINE_IS_FOR_WEAKNESS" ("NAME_OF_WEAKNESS", "NAME_OF_MEDICINE") ENABLE;
  ALTER TABLE "VLOD"."HEALING_HISTORIES" ADD CONSTRAINT "FK_HEALING__USER_HAS__USERSS" FOREIGN KEY ("LOGIN")
	  REFERENCES "VLOD"."USERSS" ("LOGIN") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table MEDICINE_IS_FOR_WEAKNESS
--------------------------------------------------------

  ALTER TABLE "VLOD"."MEDICINE_IS_FOR_WEAKNESS" ADD CONSTRAINT "FK_MEDICINE_MEDICINE__MEDICINE" FOREIGN KEY ("NAME_OF_MEDICINE")
	  REFERENCES "VLOD"."MEDICINE" ("NAME_OF_MEDICINE") ENABLE;
  ALTER TABLE "VLOD"."MEDICINE_IS_FOR_WEAKNESS" ADD CONSTRAINT "FK_MEDICINE_WEAKNESSS_WEAKNESS" FOREIGN KEY ("NAME_OF_WEAKNESS")
	  REFERENCES "VLOD"."WEAKNESS" ("NAME_OF_WEAKNESS") ENABLE;
--------------------------------------------------------
--  Ref Constraints for Table WEAKNESS_HAS_SYNDROM
--------------------------------------------------------

  ALTER TABLE "VLOD"."WEAKNESS_HAS_SYNDROM" ADD CONSTRAINT "FK_WEAKNESS_WEAKNESS__SYNDROME" FOREIGN KEY ("NAME_OF_SYNDROM")
	  REFERENCES "VLOD"."SYNDROMES" ("NAME_OF_SYNDROM") ENABLE;
  ALTER TABLE "VLOD"."WEAKNESS_HAS_SYNDROM" ADD CONSTRAINT "FK_WEAKNESS_WEAKNESS__WEAKNESS" FOREIGN KEY ("NAME_OF_WEAKNESS")
	  REFERENCES "VLOD"."WEAKNESS" ("NAME_OF_WEAKNESS") ENABLE;
